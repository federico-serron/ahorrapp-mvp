<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="Expense Tracker - Gestiona tus gastos e ingresos">
    <title>游눯 Expense Tracker Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <!-- AUTH SECTION -->
        <div id="authSection">
            <div class="header">
                <h1>游눯 Expense Tracker Pro</h1>
                <p>Gestiona tus ingresos y gastos de forma segura</p>
            </div>

            <div class="card auth-form">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="UI.switchTab('login')">Login</button>
                    <button class="tab-btn inactive" onclick="UI.switchTab('register')">Registro</button>
                </div>

                <!-- LOGIN FORM -->
                <form id="loginForm" class="tab-content">
                    <h2>Inicia Sesi칩n</h2>
                    <div class="form-group">
                        <label for="loginUsername">Usuario</label>
                        <input 
                            type="text" 
                            id="loginUsername"
                            placeholder="Tu usuario"
                            maxlength="20"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Contrase침a</label>
                        <input 
                            type="password" 
                            id="loginPassword"
                            placeholder="Tu contrase침a"
                            maxlength="128"
                            required>
                    </div>
                    <button type="submit" id="loginBtn">Login</button>
                    <div class="message" id="loginMessage"></div>
                </form>

                <!-- REGISTER FORM -->
                <form id="registerForm" class="tab-content hidden">
                    <h2>Crear Cuenta</h2>
                    <div class="form-group">
                        <label for="regUsername">Usuario (칰nico)</label>
                        <input 
                            type="text" 
                            id="regUsername"
                            placeholder="Tu usuario (3-20 caracteres)"
                            maxlength="20"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="regPassword">Contrase침a</label>
                        <input 
                            type="password" 
                            id="regPassword"
                            placeholder="Tu contrase침a (m칤n 4 caracteres)"
                            maxlength="128"
                            required>
                    </div>
                    <button type="submit" id="registerBtn">Registrarse</button>
                    <div class="message" id="registerMessage"></div>
                </form>
            </div>
        </div>

        <!-- APP SECTION -->
        <div id="appSection" class="hidden">
            <div class="header">
                <h1>游눯 Expense Tracker Pro</h1>
                <p id="userName"></p>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>

            <!-- ESTAD칈STICAS -->
            <div class="stat-grid">
                <div class="stat-card income">
                    <div class="stat-value" id="incomeTotal">$0.00</div>
                    <div class="stat-label">Ingresos</div>
                </div>
                <div class="stat-card expense">
                    <div class="stat-value" id="expenseTotal">$0.00</div>
                    <div class="stat-label">Gastos</div>
                </div>
                <div class="stat-card balance">
                    <div class="stat-value" id="balanceTotal">$0.00</div>
                    <div class="stat-label">Balance</div>
                </div>
            </div>

            <!-- GR츼FICAS -->
            <div class="charts-grid">
                <div class="card">
                    <h3>Gastos por Categor칤a</h3>
                    <div class="chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>Ingresos vs Gastos</h3>
                    <div class="chart-container">
                        <canvas id="incomeExpenseChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- NUEVA TRANSACCI칍N -->
            <div class="card">
                <h2>Nueva Transacci칩n</h2>
                <form id="transactionForm">
                    <div class="form-group">
                        <label for="description">Descripci칩n</label>
                        <input 
                            type="text" 
                            id="description"
                            placeholder="Ej: Sueldo mensual o Cine con amigos"
                            maxlength="500"
                            required>
                        <small>La app detecta autom치ticamente si es ingreso o gasto</small>
                    </div>
                    <div class="form-group">
                        <label for="amount">Monto</label>
                        <input 
                            type="number" 
                            id="amount"
                            placeholder="Ej: 100.00"
                            step="0.01"
                            max="1000000"
                            required>
                    </div>
                    <button type="submit" id="submitBtn">Registrar</button>
                    <div class="message" id="message"></div>
                </form>
            </div>

            <!-- HISTORIAL DE TRANSACCIONES -->
            <div class="card">
                <h2>Historial de Transacciones</h2>
                <div class="transactions-list" id="transactionsList">
                    <p style="color: #999; text-align: center; padding: 20px;">Cargando...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL DE EDICI칍N -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="UI.closeEditModal()">&times;</span>
            <h2>Editar Transacci칩n</h2>
            <form id="editForm">
                <div class="form-group">
                    <label for="editDescription">Descripci칩n</label>
                    <input 
                        type="text" 
                        id="editDescription"
                        maxlength="500"
                        required>
                </div>
                <div class="form-group">
                    <label for="editAmount">Monto</label>
                    <input 
                        type="number" 
                        id="editAmount"
                        step="0.01"
                        max="1000000"
                        required>
                </div>
                <button type="submit">Guardar</button>
                <button type="button" class="btn-danger" onclick="deleteTransaction()">Eliminar</button>
            </form>
        </div>
    </div>

    <!-- SCRIPTS - Cargar en orden correcto -->
    <script src="js/security.js"></script>
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
